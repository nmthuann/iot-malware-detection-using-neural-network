import tensorflow as tf

img_height = 224
img_width = 224
batch_size = 2

new_model = tf.keras.models.load_model('saved_model/model_1')

print(new_model)

test_ds = tf.keras.utils.image_dataset_from_directory(
    'test', labels='inferred', 
    label_mode='int',
    color_mode='rgb', 
    batch_size=batch_size, 
    image_size=(img_height,img_width), 
    shuffle=False,
    interpolation='bilinear'
)

new_model.summary()

evaluation = new_model.evaluate(test_ds, return_dict=True)

print(evaluation)
print()

for name, value in evaluation.items():
    print(f"{name}: {value:.4f}")
