import tensorflow as tf

img_height = 224
img_width = 224
batch_size = 32

new_model = tf.keras.models.load_model('../saved_model/model_1')

test_ds = tf.keras.utils.image_dataset_from_directory(
    '../test', labels='inferred', 
    label_mode='int',
    color_mode='rgb', 
    batch_size=batch_size, 
    image_size=(img_height,img_width), 
    shuffle=False,
    interpolation='bilinear'
)

print(test_ds)

new_model.sumary()


evaluation = new_model.evaluate(test_ds, return_dict=True)
print(evaluation)
print()

for name, value in evaluation.items():
    print(f"{name}: {value:.4f}")